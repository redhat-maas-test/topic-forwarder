allprojects  {
    group = 'enmasse'
    version = 'latest'
}

ext {
    artemisVersion = '2.0.0'
    vertxProtonVersion = '3.4.1'
    slf4jVersion = '1.7.21'
    hamcrestVersion = '1.3'
    junitVersion = '4.12'
    mockitoVersion = '2.0.52-beta'
    repoUser = ''
    repoPass = ''
}

apply plugin: 'java'
sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
    maven { url "http://repo.maven.apache.org/maven2" }
    maven { url "https://jitpack.io" }
}

description = 'Broker message forwarder'
dependencies {
    compile 'com.github.EnMasseProject:admin:master-SNAPSHOT'
    compile "io.vertx:vertx-proton:${vertxProtonVersion}"
    compile "org.slf4j:slf4j-api:${slf4jVersion}"
    compile "org.slf4j:slf4j-log4j12:${slf4jVersion}"
    testCompile "junit:junit:${junitVersion}"
    testCompile "org.mockito:mockito-core:${mockitoVersion}"
    testCompile "org.hamcrest:hamcrest-all:${hamcrestVersion}"
    testCompile("org.apache.activemq:artemis-server:${artemisVersion}") {
        exclude group: "io.netty", module: "netty-all"
    }
    testCompile("org.apache.activemq:artemis-amqp-protocol:${artemisVersion}") {
        exclude group: "io.netty", module: "netty-all"
    }
}

apply plugin: 'application'
mainClassName = 'enmasse.broker.forwarder.Main'
applicationDefaultJvmArgs = ["-Dvertx.cacheDirBase=/tmp"]

apply plugin: 'maven-publish'
publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
            artifact distZip
        }
    }

    repositories {
        maven {
            url 'https://oss.sonatype.org/content/repositories/snapshots/'
            credentials {
                username "${repoUser}"
                password "${repoPass}"
            }
        }
    }
}
